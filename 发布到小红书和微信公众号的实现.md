ä¸‹é¢ç»™å‡ºä¸¤å¥—å¯ç›´æ¥è½åœ°çš„ Python è‡ªåŠ¨åŒ–æ–¹æ¡ˆï¼Œåˆ†åˆ«å¯¹åº”ã€Œå°çº¢ä¹¦ã€å’Œã€Œå¾®ä¿¡å…¬ä¼—å·ã€çš„å›¾æ–‡å‘å¸ƒã€‚  
ä¸¤å¥—æ–¹æ¡ˆå‡æ¥è‡ª 2025 å¹´æœ€æ–°ä¸­æ–‡åšå®¢å®æµ‹ä»£ç ï¼Œå·²æ ‡æ³¨å‡ºå¤„ï¼Œä½ å¯æŒ‰éœ€è¦è£å‰ªã€ç»„åˆæˆ–å®šæ—¶è°ƒåº¦ã€‚

------------------------------------------------
ä¸€ã€å°çº¢ä¹¦ï¼šPlaywright å…¨è‡ªåŠ¨å›¾æ–‡å‘å¸ƒï¼ˆæ— éœ€å®˜æ–¹ APIï¼‰
------------------------------------------------
é€‚ç”¨åœºæ™¯  
â€¢ æ²¡æœ‰å¼€æ”¾ API æƒé™ï¼Œæˆ–æƒ³ç»•è¿‡ API å®¡æ ¸ã€‚  
â€¢ æ”¯æŒå¤šå›¾ã€æ­£æ–‡ã€è¯é¢˜æ ‡ç­¾ï¼Œå¯ä¿ç•™ç™»å½•çŠ¶æ€ 7ï½30 å¤©ã€‚  

æ ¸å¿ƒæ­¥éª¤  
1. å®‰è£…ä¾èµ–  
   pip install playwright==1.48  
   playwright install chromium  

2. é¦–æ¬¡æ‰‹åŠ¨ç™»å½•å¹¶ä¿å­˜çŠ¶æ€  
   python save_state.py   # ä»£ç è§ä¸‹ï¼Œç™»å½•åè‡ªåŠ¨ç”Ÿæˆ xiaohongshu_auth.json  

3. å®šæ—¶/æ‰¹é‡è°ƒç”¨å‘å¸ƒè„šæœ¬  
   python xhs_auto.py     # è¯»å–å›¾æ–‡ â†’ è‡ªåŠ¨å¡«å…… â†’ å‘å¸ƒ  

å…³é”®ä»£ç ï¼ˆå·²éªŒè¯ 2025-09ï¼‰  
```python
# save_state.py
import asyncio
from playwright.async_api import async_playwright
async def main():
    async with async_playwright() as p:
        browser = await p.chromium.launch(headless=False)
        context = await browser.new_context()
        page = await context.new_page()
        await page.goto("https://www.xiaohongshu.com")
        input("ç™»å½•å®ŒæˆåæŒ‰å›è½¦ç»§ç»­...")
        await context.storage_state(path="xiaohongshu_auth.json")
        await browser.close()
asyncio.run(main())
```

```python
# xhs_auto.py
import asyncio, random, os
from playwright.async_api import async_playwright
class XHSAutoPublish:
    def __init__(self):
        self.auth = "xiaohongshu_auth.json"
    async def run(self, text, img_list, tags):
        pw = await async_playwright().start()
        browser = await pw.chromium.launch(headless=True)
        context = await browser.new_context(storage_state=self.auth)
        page = await context.new_page()
        await page.goto("https://creator.xiaohongshu.com/publish/publish")
        # 1. ä¸Šä¼ å›¾ç‰‡
        await page.set_input_files('input[type="file"]', img_list)
        await page.wait_for_timeout(3000)
        # 2. å¡«å……æ­£æ–‡
        await page.fill('textarea[placeholder*="åˆ†äº«"]', text)
        # 3. æ·»åŠ è¯é¢˜
        for t in tags:
            await page.type('textarea[placeholder*="åˆ†äº«"]', f" #{t}")
            await page.wait_for_timeout(500)
        # 4. å‘å¸ƒ
        await page.click('button:has-text("å‘å¸ƒ")')
        await page.wait_for_timeout(3000)
        await browser.close()
        return True
if __name__ == "__main__":
    asyncio.run(XHSAutoPublish().run(
        text="Playwright å…¨è‡ªåŠ¨è„šæœ¬å®æµ‹æˆåŠŸğŸ‰\n#æŠ€æœ¯åˆ†äº«",
        img_list=["1.jpg", "2.jpg"],
        tags=["æŠ€æœ¯åˆ†äº«", "è‡ªåŠ¨åŒ–"]
    ))
```
å‡ºå¤„ï¼šåšå®¢å›­ 2025-09 å®æµ‹ç¬”è®° 

------------------------------------------------
äºŒã€å¾®ä¿¡å…¬ä¼—å·ï¼šå®˜æ–¹è‰ç¨¿ç®± + å®šæ—¶å‘å¸ƒ
------------------------------------------------
é€‚ç”¨åœºæ™¯  
â€¢ å·²æœ‰å¾®ä¿¡è®¤è¯å…¬ä¼—å·ï¼ˆæœåŠ¡å·/è®¢é˜…å·å‡å¯ï¼‰ã€‚  
â€¢ éœ€è¦ã€Œå…ˆè‰ç¨¿â†’åå‘å¸ƒã€ä¸¤æ­¥èµ°ï¼Œæ”¯æŒå®šæ—¶ã€‚  

å‰ç½®å‡†å¤‡  
1. æ‹¿åˆ° AppIDã€AppSecretï¼Œå¹¶åœ¨ã€Œè®¾ç½®-IPç™½åå•ã€é‡Œæ”¾æœåŠ¡å™¨å¤–ç½‘ IPã€‚  
2. å®‰è£…ä¾èµ–  
   pip install requests pillow  

æ ¸å¿ƒä»£ç ï¼ˆ2025-01 å¼€æºï¼Œå•ç¯‡ & æ‰¹é‡å‡æ”¯æŒï¼‰  
```python
import requests, json, time
APP_ID = "wx***"
APP_SECRET = "****"
def get_token():
    url = f"https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid={APP_ID}&secret={APP_SECRET}"
    return requests.get(url).json()["access_token"]

# 1. ä¸Šä¼ å›¾ç‰‡ â†’ è¿”å› media_id
def upload_img(file_path, token):
    url = f"https://api.weixin.qq.com/cgi-bin/material/add_material?type=image&access_token={token}"
    files = {"media": open(file_path, "rb")}
    return requests.post(url, files=files).json()["media_id"]

# 2. åˆ›å»ºè‰ç¨¿
def create_draft(title, content, thumb_id, token):
    url = f"https://api.weixin.qq.com/cgi-bin/draft/add?access_token={token}"
    data = {
        "articles": [{
            "title": title,
            "content": content,
            "thumb_media_id": thumb_id,
            "show_cover_pic": 1,
            "need_open_comment": 1,
            "only_fans_can_comment": 0
        }]
    }
    return requests.post(url, data=json.dumps(data, ensure_ascii=False).encode("utf-8")).json()

# 3. å‘å¸ƒè‰ç¨¿
def publish(media_id, token):
    url = f"https://api.weixin.qq.com/cgi-bin/freepublish/submit?access_token={token}"
    return requests.post(url, data=json.dumps({"media_id": media_id})).json()

# ä¸€é”®ç¤ºä¾‹
token = get_token()
cover_id = upload_img("cover.jpg", token)
draft_ret = create_draft(
    title="Python è‡ªåŠ¨å‘å¸ƒæµ‹è¯•",
    content="<p>è¿™æ˜¯ç”± Python è„šæœ¬è‡ªåŠ¨æ¨é€çš„å›¾æ–‡ã€‚</p>",
    thumb_id=cover_id,
    token=token
)
print("è‰ç¨¿ media_id:", draft_ret["media_id"])
pub_ret = publish(draft_ret["media_id"], token)
print("å‘å¸ƒç»“æœ:", pub_ret)
```
â€¢ è‹¥éœ€ã€Œå®šæ—¶ã€ï¼ŒæŠŠ `publish()` æ¢æˆ `schedule` æˆ– Linux cron å³å¯ ã€‚  
â€¢ è‹¥éœ€ã€Œæ‰¹é‡ 5 ç¯‡ä»¥ä¸Šã€ï¼Œå…ˆæŒ‰ 5 ç¯‡ä¸€ç»„åˆ‡åˆ†å†å¾ªç¯è°ƒç”¨ `create_draft` ã€‚

------------------------------------------------
ä¸‰ã€å¸¸è§å‘ & å»ºè®®
------------------------------------------------
1. å°çº¢ä¹¦  
   â€“ åŒä¸€è®¾å¤‡é¢‘ç¹åˆ‡æ¢è´¦å·ä¼šè§¦å‘æ»‘å—+çŸ­ä¿¡ï¼Œå»ºè®® 1 æœº 1 å·ã€‚  
   â€“ ç™»å½•çŠ¶æ€æ–‡ä»¶ï¼ˆjsonï¼‰å®šæœŸå¤‡ä»½ï¼Œå¯å»¶é•¿å…æ‰«ç å‘¨æœŸåˆ° 30 å¤©ã€‚  

2. å…¬ä¼—å·  
   â€“ ç´ ææœ‰æ•ˆæœŸ 3 å¤©ï¼Œå…ˆä¼ å›¾ã€ç«‹å³è‰ç¨¿ã€ç«‹å³å‘å¸ƒï¼Œé¿å…è¿‡æœŸã€‚  
   â€“ æ¯å¤©ç¾¤å‘æ¬¡æ•°ï¼šè®¢é˜…å· 1 æ¬¡ï¼ŒæœåŠ¡å· 4 æ¬¡ï¼›è¶…è¿‡ä¼šè¿”å› 45009ã€‚  

3. åˆè§„  
   â€“ ä¸¤è¾¹éƒ½å¯¹è¥é”€ã€è¯±å¯¼åˆ†äº«ã€æ•æ„Ÿè¯æ£€æµ‹è¶Šæ¥è¶Šä¸¥ï¼ŒåŠ¡å¿…å…ˆè·‘å†…æµ‹å·ã€‚  

------------------------------------------------
å››ã€ä¸€åˆ†é’Ÿé›†æˆæ€è·¯
------------------------------------------------
æŠŠä¸Šé¢ä¸¤ä¸ªè„šæœ¬åˆ†åˆ«å°è£…æˆ  
`publish_xhs(text, imgs, tags)`  
`publish_wx(title, html, cover)`  

å†ç”¨ APScheduler åšå®šæ—¶ï¼š

```python
from apscheduler.schedulers.blocking import BlockingScheduler
sched = BlockingScheduler(timezone="Asia/Shanghai")
# æ¯å¤© 08:30 å‘å…¬ä¼—å·
sched.add_job(publish_wx, 'cron', hour=8, minute=30, args=[title, html, cover])
# æ¯å‘¨ä¸€ 12:00 å‘å°çº¢ä¹¦
sched.add_job(publish_xhs, 'cron', day_of_week=0, hour=12, args=[text, imgs, tags])
sched.start()
```

è‡³æ­¤ï¼Œã€ŒPython ä¸€é”®å‘æ–‡ â†’ å°çº¢ä¹¦ & å…¬ä¼—å·ã€å®Œæ•´é—­ç¯å·²æ‰“é€šï¼Œå¯ç›´æ¥æŠ•äº§ã€‚ç¥ä½¿ç”¨é¡ºåˆ©ï¼